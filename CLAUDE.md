# Claude Configuration - 비바빌리지 학급 경제 플랫폼

이 파일은 비바빌리지 SEC(Small Economy in the Classroom) 기반 학급 경제 운영 웹 플랫폼 개발을 위한 Claude Code 설정입니다.

## 프로젝트 개요
- SEC 프로그램 기반 초등 학급 경제 운영 웹 플랫폼
- React + TypeScript + Vite + TailwindCSS (Frontend)
- Node.js + Express + TypeORM + PostgreSQL (Backend)
- MVP 버전으로 로컬에서 작동하는 교육용 플랫폼

## 개발 명령어

### 프론트엔드만 사용 (백엔드 미사용)
```bash
cd vivaa-town/client
npm run dev    # http://localhost:6100
npm run build  # 프로덕션 빌드
npm run lint   # ESLint 실행
```

**현재 개발 방침**: 백엔드는 사용하지 않고 프론트엔드만으로 개발 진행
- Mock 데이터 또는 로컬 스토리지 활용
- 추후 필요시 백엔드 연동 예정

### 백엔드 (향후 사용 예정)
```bash
cd vivaa-town/server
npm run dev    # http://localhost:7001 (현재 미사용)
npm run build  # TypeScript 컴파일
npm run start  # 프로덕션 실행
```

## 현재 구현 상태

### ✅ 완료된 기능 (2025.09.25 기준)
- 프로젝트 구조 설정 (React + Express)
- 기본 라우팅 구성 (Home, Classes, Students, Jobs, Transactions, Banking, Stocks, Achievements)
- TypeORM 엔티티 설계 (Class, User)
- 기본 서버 API 엔드포인트 (/health, /test)
- TailwindCSS 설정
- **Zustand 기반 상태 관리 시스템**
- **학급 생성/관리 시스템**
- **학생 관리 시스템 (CRUD)**
- **직업 관리 시스템 (CRUD)**
- **실시간 대시보드** (차트, 거래 피드, 경제 지표)
- **실시간 알림 시스템** (토스트, 이벤트 알림)
- **고급 급여 시스템** (일괄 지급, 세금 공제, 급여 명세서)
- **신용등급 시스템** (신용점수, 신용등급, 예금이자 우대, 행동 관리)
- **🏦 예금/적금 시스템** (정기예금, 자유적금, 복리 이자 계산)
- **📈 주식 투자 시스템** (실시간 차트, 포트폴리오, 수익률 계산)
- **🏆 업적/뱃지 시스템** (32종 업적, 4단계 등급)
- **📰 시장 뉴스 시스템** (주가 알림, 시장 동향)
- **🔍 교사용 분석 대시보드** (경제 지표, 활동 히트맵, 거래 패턴)
- **🏠 홈 화면 통합 대시보드** (탭 기반 분석 인터페이스)
- **🎮 종합 시연용 데이터** (15명 학생, 8개 주식, 30일 거래 데이터)
- **🚀 프리미엄 AI 기능 시스템** (API 키 관리, 유료 기능 모달, 프리미엄 스토어)
- **🤖 AI 교사 코멘트** (Gemini 1.5 Flash 기반 전문적 경제교육 피드백)
- **📊 학생 포트폴리오** (개별 경제활동 종합 분석 및 AI 컨설팅)
- **🏛️ 은행장(교사) 전용 시스템** (기준금리 조정, 우대금리 설정, 은행 운영 현황)

### 💳 새로 구현된 신용등급 시스템
- **신용점수**: 300~850점 미국식 신용점수 체계 적용
- **신용등급**: A+부터 D까지 7단계 등급 시스템
- **예금이자 우대**: 신용점수에 따른 이자율 차등 적용 (1.5%~5%)
- **행동 관리**: 교사가 지각, 숙제미제출, 도서연체 등 수동 차감 가능
- **리더보드**: 신용점수와 총수익 기준 실시간 랭킹
- **자동 점수 관리**: 거래 활동 시 점수 상승, 업적 달성 보너스

### 🚧 진행 중/미완성
- 💳 **학생용 디지털 지갑 UI** (카드 플립 애니메이션, 3D 효과)
- 📱 **학생 전용 페이지 및 QR코드 거래 시스템**
- 🎨 **UI/UX 개선** (애니메이션, 아이콘, 색상 테마 최적화)
- 📄 **PDF 보고서 자동 생성** (월간 경제 활동 보고서, 학기말 포트폴리오)

### ⏸️ 보류된 기능 (백엔드 관련)
- PostgreSQL 데이터베이스 연결
- JWT 인증 시스템
- 실제 API 구현 (CRUD)

## 🌐 웹 배포 정보

### GitHub Pages 배포
- **저장소**: https://github.com/suhmieum/sec
- **웹사이트**: https://suhmieum.github.io/sec/
- **배포 방식**: main 브랜치 루트 디렉토리에서 자동 배포
- **빌드 설정**: Vite 빌드 결과물을 프로젝트 루트로 복사

### 배포 명령어
```bash
# GitHub에 변경사항 업데이트 후 자동 배포
cd sec-project
git add .
git commit -m "Update website"
git push origin main
```

## 데이터 모델 (Zustand Stores)

### Classroom Store
- 학급 기본 정보 (name, currencyUnit, treasury, donation)
- 설정 옵션 (taxRate, payCycle, approvalRequired, salaryBase)
- CRUD 작업 (생성, 수정, 삭제, 조회)

### Student Store
- 학생 기본 정보 (name, pin4, balance, active)
- **신용등급 데이터** (creditScore, creditGrade, totalEarnings, totalTransactions, achievements)
- **행동 기록** (lateCount, homeworkMissed, bookOverdue)
- 잔고 관리 (입금, 출금, 이체)
- 직업 할당 및 PIN 관리
- **신용점수 & 업적 시스템** (점수 계산, 등급 변환, 이자율 계산, 랭킹)

### Job Store
- 직업 정보 (title, description, salary, maxPositions, currentPositions)
- 직업 할당 관리
- CRUD 작업

### App Store
- 전역 상태 (currentClassId, lastLogin)
- 앱 초기화 및 설정

### Premium Store
- API 키 관리 (geminiApiKey, isPremiumActive)
- API 키 유효성 검증 (validateApiKey)
- 프리미엄 기능 상태 관리

### Bank Admin Store
- 은행장 설정 관리 (baseInterestRate, creditGradeBonuses)
- 은행 운영 통계 계산 (총예치금, 신용점수분포, 증감률)
- 정책 변경 이력 추적 (변경사유, 변경자, 변경일시)

## 주요 기능 요구사항 (PRD 기반)

### 교사용 기능
- 학급 경제 개설/관리
- 직업 및 급여 시스템
- 아이템 상점 운영
- 은행 상품 관리
- 세금 및 국고 관리
- 경제 지표 모니터링

### 학생용 기능
- 개인 통장 관리
- 직업 활동 및 급여 수령
- 아이템 구매/거래
- 예금 및 대출
- 주식 투자
- 창업 활동

## Git 커밋 가이드
- feat: 새로운 기능 추가
- fix: 버그 수정
- docs: 문서 수정
- style: 코드 스타일 변경
- refactor: 코드 리팩토링
- test: 테스트 코드 추가/수정

## 개발 우선순위 (프론트엔드 중심)
1. ✅ 프론트엔드 개발 환경 구성 (완료)
2. ✅ Zustand 상태 관리 시스템 구축 (완료)
3. ✅ 학급 생성/관리 UI 구현 (완료)
4. ✅ 학생 등록/관리 UI 구현 (완료)
5. ✅ 직업 관리 시스템 구현 (완료)
6. ✅ 실시간 대시보드 & 알림 시스템 (완료)
7. ✅ 고급 급여 시스템 (세금, 급여명세서) (완료)
8. ✅ 신용등급 시스템 (신용점수, 등급, 이자우대, 행동관리) (완료)
9. 🚧 가상 화폐 디자인 & 디지털 지갑
10. 🚧 교사용 분석 대시보드
11. 🚧 출석/수업 태도 모니터링
12. 🚧 UI/UX 개선 (애니메이션, 테마)

## 기술 스택 & 아키텍처

### 프론트엔드
- **React 18** + **TypeScript** + **Vite**
- **TailwindCSS** (스타일링) + **@tailwindcss/postcss** (PostCSS 플러그인)
- **Zustand** (상태 관리) + **Zod** (스키마 검증)
- **Framer Motion** (애니메이션)
- **React CountUp** (숫자 애니메이션)
- **Chart.js** + **react-chartjs-2** (차트 라이브러리)
- **React Hook Form** (폼 관리)
- **jsPDF** + **html2canvas** + **jspdf-autotable** (PDF 생성)
- **UUID** (고유 ID 생성)

### 상태 관리 패턴
- **Zustand Stores**: 분리된 스토어 (App, Classroom, Student, Job, Stock, Savings, Achievement, Analytics, Market, AIPlan, Portfolio, Premium, BankAdmin)
- **LocalStorage 어댑터**: 데이터 영속성
- **Schema 검증**: Zod를 통한 타입 안전성
- **옵티미스틱 업데이트**: 즉시 UI 반영
- **실시간 계산**: 경제 지표, 포트폴리오 수익률, 이자 계산

### 컴포넌트 구조
```
src/
├── components/           # 재사용 컴포넌트
│   ├── Dashboard.tsx    # 실시간 대시보드 (분석 탭 통합)
│   ├── Leaderboard.tsx  # 게이미피케이션 리더보드
│   ├── NotificationSystem.tsx # 알림 시스템
│   └── PremiumModal.tsx # 프리미엄 기능 모달
├── pages/               # 페이지 컴포넌트
│   ├── Classes.tsx      # 학급 관리 (시연 데이터 생성)
│   ├── Students.tsx     # 학생 관리 (급여 시스템 포함)
│   ├── Jobs.tsx         # 직업 관리
│   ├── Transactions.tsx # 거래 내역
│   ├── Banking.tsx      # 예금/적금 시스템
│   ├── Stocks.tsx       # 주식 투자 (차트, 뉴스, 포트폴리오)
│   ├── Achievements.tsx # 업적/뱃지 시스템
│   ├── Analytics.tsx    # 교사용 분석 대시보드
│   ├── AIPlan.tsx       # AI 활동 계획 (프리미엄)
│   ├── PortfolioList.tsx # 학생 포트폴리오 목록 (프리미엄)
│   ├── PortfolioDetailed.tsx # 학생 포트폴리오 상세 (프리미엄)
│   └── Items.tsx        # 아이템 상점
├── state/               # Zustand 스토어 (13개 스토어)
├── schemas/             # Zod 스키마
├── utils/               # 유틸리티 함수 (generateDemoData.ts)
└── storage/             # 스토리지 어댑터
```

## 백엔드 연동 (향후 계획)
1. PostgreSQL 연결 및 기본 CRUD API
2. 인증 시스템 (JWT)
3. 프론트엔드-백엔드 통합

## 최근 업데이트 (2025.09.26)
### 🏛️ 은행장(교사) 전용 관리 시스템 구축 (2025.09.26)
- 🏦 **Banking UI 완전 리디자인**: 복잡한 카드 플립 애니메이션 제거, 직관적인 탭 네비게이션으로 전환
- 🎨 **전문적인 뱅킹 테마**: 슬레이트(Navy) + 에메랄드(Mint) 색상 조합으로 신뢰감 있는 디자인
- 📱 **모바일 최적화**: 반응형 레이아웃, 터치 친화적 버튼, 스크롤 가능한 탭 네비게이션
- ⚙️ **은행장 전용 탭 추가**: 교사만 접근 가능한 고급 관리 기능

### 💰 새로 구현된 은행장 핵심 기능
- **📊 실시간 은행 운영 현황**: 총예치금, 계좌수, 평균신용점수, 기준금리 한눈에 확인
- **📈 신용점수 분포도**: A+~D등급 학생 수 프로그레스 바로 시각화, 색상별 등급 구분
- **💸 기준금리 조정 시스템**: 0~20% 범위 실시간 조정, 변경사유 기록, 정책 이력 관리
- **🏆 신용등급별 우대금리 설정**: 7단계 등급별 개별 금리 조정 (-1.0% ~ +2.0%)
- **📅 전월 대비 증감률**: 예치금 증감 추이 모니터링 (시뮬레이션 데이터)

### 🔧 기술적 개선사항
- **bankAdminStore 신규 생성**: 은행장 설정 전용 Zustand 스토어 구축
- **동적 금리 시스템**: 기준금리 변경 시 모든 상품 금리 자동 연동
- **실시간 통계 계산**: 학급별 예치금, 신용점수 분포 등 동적 집계
- **데이터 영속성**: LocalStorage 기반 설정 저장 및 변경 이력 추적
- **타입 안전성**: TypeScript + Zod 스키마로 안전한 데이터 처리

### 🎓 교육적 가치
- **실제 중앙은행 정책 체험**: 교사가 금리 정책을 직접 결정하고 파급 효과 관찰
- **경제 정책의 영향 학습**: 기준금리 변경이 모든 금융상품에 미치는 실시간 효과 확인
- **신용 관리 중요성**: 등급별 혜택 차이를 통한 신용 관리의 가치 교육
- **경제 지표 분석**: 다양한 통계를 활용한 경제 상황 판단 능력 배양

## 이전 업데이트 (2025.09.25)
### 🚀 프리미엄 AI 기능 시스템 구축 (2025.09.25)
- 🔐 **프리미엄 모달 시스템**: AI 계획과 포트폴리오를 유료 기능으로 전환
- 🗝️ **API 키 관리**: 사용자 직접 Gemini API 키 입력으로 기능 활성화
- 🎯 **프리미엄 스토어**: LocalStorage 기반 API 키 영구 저장 및 검증 시스템
- 🔒 **보안 강화**: 하드코딩된 API 키 완전 제거, 환경변수 삭제
- 🎨 **하늘색 테마**: 모든 프리미엄 기능을 일관된 브랜드 컬러로 통일

### 🤖 AI 교사 코멘트 시스템 대폭 개선
- 📊 **전문가급 분석**: 15개 상세 지표 기반 종합적 경제활동 분석
- 📝 **고품질 피드백**: 500-700자 분량의 전문적인 교육 컨설팅
- 🏗️ **구조화된 분석**: 성과→강점→개선→실행의 4단계 체계적 피드백
- 💡 **실용적 가이드**: 구체적 목표 수치가 포함된 액션 아이템 제공
- 🎯 **UI/UX 개선**: 포트폴리오 상단에 눈에 띄는 AI 코멘트 생성 카드 배치

### 🌟 새로 구현된 프리미엄 기능
- **PremiumModal 컴포넌트**: 유료 기능 안내 및 API 키 입력 인터페이스
- **premiumStore**: API 키 유효성 검증 및 프리미엄 상태 관리
- **AI 경제교육 전문가**: Gemini 1.5 Flash 기반 고품질 교사 피드백
- **포트폴리오 AI 분석**: 자산 구성, 거래 패턴, 학습 태도 종합 분석
- **Google AI Studio 연동**: 무료 API 키 발급 가이드 링크 제공

### 💻 기술적 개선
- **geminiService 개선**: 프리미엄 스토어 기반 동적 API 키 로딩
- **모델 최적화**: gemini-2.0-flash-exp → gemini-1.5-flash 안정화
- **토큰 한도 증대**: 300 → 1000 토큰으로 장문 응답 지원
- **순환 의존성 해결**: 지연 초기화 패턴으로 안전한 모듈 로딩
- **상태 관리 확장**: 기존 10개 스토어에 premiumStore 추가

### 🎨 이전 업데이트 (2025.09.24) - 브랜딩 및 UX 개선
- 🏷️ **비바타운 → 비바빌리지 리브랜딩** (전체 UI/타이틀 변경)
- 🎯 **사이드바 로고 간소화** (타운 아이콘 제거, 심플 텍스트 로고)
- 🚀 **최초 진입 UX 개선** (학급 없으면 자동 학급 관리 페이지 이동)
- 💡 **빠른 시작 팁 UI 단순화** (명확한 시연용 학급 생성 안내)
- ⏳ **시연용 학급 생성 로딩 스피너** (생성 진행 상황 시각화)
- ⚡ **활동 히트맵 성능 최적화** (데이터량 73% 감소: 2,520개→690개)
- 🎨 **홈 화면 시간 표시 폰트 개선** (Pretendard 폰트 적용)
- 📋 **학생 관리 UI 개선** (보기 모드 토글 우측 정렬)

### 💻 기술적 개선
- **성능 최적화**: 활동 히트맵 데이터 생성 로직 개선
- **코드 품질**: 타입 안전성 및 에러 처리 강화
- **배포 자동화**: GitHub Pages 배포 프로세스 개선

### 🌐 이전 업데이트 (2025.09.23)
- 🏦 **예금/적금 시스템 완전 구현** (정기예금, 적금, 이자 계산)
- 📈 **주식 투자 시스템 구현** (실시간 차트, 포트폴리오, 거래 내역)
- 🏆 **업적/뱃지 시스템 구현** (거래, 저축, 투자, 리더십 업적)
- 📊 **주식 차트 시각화 및 뉴스 시스템** (Chart.js 기반)
- 📰 **실시간 시장 뉴스 시스템** (주가 변동 알림)
- 🔍 **교사용 분석 대시보드** (경제 활동 히트맵, 경제 건전성 지표)
- 🏠 **홈 화면 분석 대시보드 통합** (전체 개요, 활동 히트맵, 거래 패턴)
- 🎮 **시연용 종합 데이터 생성** (15명 학생, 8개 주식, 30일 거래 데이터)
- 🐛 **JSX 문법 오류 및 TailwindCSS 설정 문제 해결**
- 🌐 **GitHub Pages 웹 배포 완료** (https://suhmieum.github.io/sec/)

### 🏛️ 새로 구현된 금융 시스템
- **예금/적금**: 정기예금 3/6/12개월, 자유적금, 실시간 이자 계산
- **주식 투자**: 4개 섹터(환경/교육/기술/식품) 8종목, 실시간 차트
- **포트폴리오**: 수익률 계산, 거래 내역, 배당금 시뮬레이션
- **업적 시스템**: 32가지 업적, 브론즈/실버/골드/플래티넘 등급
- **시장 뉴스**: 주가 변동 알림, 시장 동향 분석

### 📊 분석 대시보드 기능
- **경제 지표**: 지니계수, 인플레이션율, 시장참여율, 저축률, 고용률
- **활동 히트맵**: 학생별 요일/시간대 활동 패턴 분석
- **거래 패턴**: 매수/매도 비율, 거래 스타일 분석, 피크 시간대
- **위험 학생 식별**: 경제적 위험 요소 자동 감지
- **트렌드 예측**: 경제 성장/안정/하락 예측 모델

### 🎯 시연 데이터 현황
- **학생**: 15명 (다양한 경제 활동 패턴)
- **직업**: 7개 (월급 80~180 비바코인)
- **주식**: 8종목 (30일 가격 변동 데이터)
- **거래**: 실제적인 매수/매도 패턴
- **예금/적금**: 다양한 상품 가입 내역
- **업적**: 모든 카테고리별 달성 현황
- **활동 히트맵**: 690개 레코드 (주중 수업시간 + 주말 대표시간)

### ⚡ 성능 개선 사항
- **로딩 시간**: 시연용 학급 생성 시간 2-3초 단축
- **데이터 최적화**: 활동 히트맵 73% 경량화
- **사용자 경험**: 로딩 스피너 및 진행 상태 표시